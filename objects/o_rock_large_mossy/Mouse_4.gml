// Only respond to clicks when waiting
if (state == "waiting_for_click") {
    state = "shaking";
}